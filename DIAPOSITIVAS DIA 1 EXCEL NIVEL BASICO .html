<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Básico - Día 1: Dominando la Interfaz y los Datos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .slide {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            width: 100%;
        }
        .slide.active {
            display: flex;
            opacity: 1;
        }
        .excel-grid {
            display: grid;
            border: 1px solid #d1d5db;
        }
        .excel-cell, .excel-header {
            border: 1px solid #d1d5db;
            padding: 4px 8px;
            text-align: center;
            font-size: 0.875rem;
            min-height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .excel-header {
            background-color: #e5e7eb;
            font-weight: 600;
        }
        .row-header {
            background-color: #e5e7eb;
            font-weight: 600;
        }
        .excel-cell.editable {
            background-color: #fff;
            cursor: text;
            justify-content: flex-start;
        }
        .excel-cell.active-cell {
            outline: 2px solid #107c41;
            outline-offset: -2px;
            z-index: 10;
        }
        .hotspot {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: rgba(16, 185, 129, 0.7);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
            transition: transform 0.2s, background-color 0.2s;
            border: 2px solid white;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }
        .hotspot:hover {
            transform: scale(1.2);
            background-color: rgba(5, 150, 105, 0.9);
        }
        .hotspot-info {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            width: 300px;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .hotspot-info.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        .feedback {
            display: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 500;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        .feedback.success {
            display: block;
            background-color: #d1fae5;
            color: #065f46;
        }
        .feedback.error {
            display: block;
            background-color: #fee2e2;
            color: #991b1b;
        }
        @keyframes fill-down {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .flash-fill-item { animation: fill-down 0.5s ease-out forwards; }
        .gemini-btn {
            background: linear-gradient(135deg, #4285F4, #9B59B6, #CF2D7A, #F4B400);
            background-size: 400% 400%;
            animation: gradient 10s ease infinite;
            color: white; border: none; padding: 10px 20px;
            border-radius: 8px; font-weight: 600; cursor: pointer; transition: transform 0.2s;
        }
        .gemini-btn:hover { transform: scale(1.05); }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .loader {
            border: 4px solid #f3f3f3; border-top: 4px solid #107c41; border-radius: 50%;
            width: 30px; height: 30px; animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #ai-tutor-fab {
            position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 1000;
        }
        #ai-tutor-modal {
            position: fixed; bottom: 100px; right: 30px; width: 90%; max-width: 400px;
            height: 500px; background-color: white; border-radius: 16px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.25); display: flex; flex-direction: column;
            transform: scale(0.95) translateY(20px); opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease; pointer-events: none; z-index: 999;
        }
        #ai-tutor-modal.visible { transform: scale(1) translateY(0); opacity: 1; pointer-events: auto; }
        .chat-message { padding: 8px 12px; border-radius: 12px; max-width: 80%; margin-bottom: 8px; }
        .user-message { background-color: #107c41; color: white; align-self: flex-end; }
        .ai-message { background-color: #f3f4f6; color: #1f2937; align-self: flex-start; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-6xl bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden" style="height: 90vh;">
        <header class="bg-[#107c41] text-white p-4 flex justify-between items-center shadow-md z-10 flex-shrink-0">
            <h1 class="text-xl font-bold">Excel Básico - Día 1</h1>
            <p class="text-sm font-medium">Dominando la Interfaz y los Datos Fundamentales</p>
        </header>

        <main id="slides-container" class="flex-grow p-6 md:p-10 relative overflow-y-auto min-h-0">
            <!-- Diapositiva 1: Título -->
            <div id="slide-1" class="slide active flex-col items-center justify-center text-center">
                <div class="mb-4"><svg class="w-24 h-24 text-[#107c41]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V7a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div>
                <h2 class="text-4xl md:text-5xl font-bold text-gray-800">Día 1</h2>
                <p class="text-xl md:text-2xl text-gray-600 mt-2">Dominando la Interfaz y los Datos Fundamentales</p>
                <p class="mt-8 text-gray-500">Usa los botones de navegación para comenzar</p>
            </div>

            <!-- Diapositiva 2: Objetivos -->
            <div id="slide-2" class="slide flex-col justify-center">
                 <div class="w-full">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Objetivos de Hoy</h2>
                    <ul class="space-y-4 text-lg text-gray-700 w-full max-w-2xl mx-auto">
                        <li class="flex items-start p-3 bg-gray-50 rounded-lg">
                            <svg class="w-6 h-6 text-green-600 mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            <span>Perder el miedo y navegar con <span class="font-semibold text-green-700">confianza</span> por la interfaz de Excel.</span>
                        </li>
                        <li class="flex items-start p-3 bg-gray-50 rounded-lg">
                            <svg class="w-6 h-6 text-green-600 mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            <span>Introducir, editar y corregir datos de forma <span class="font-semibold text-green-700">eficiente</span>.</span>
                        </li>
                        <li class="flex items-start p-3 bg-gray-50 rounded-lg">
                            <svg class="w-6 h-6 text-green-600 mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            <span>Descubrir herramientas <span class="font-semibold text-green-700">"mágicas"</span> como el Relleno Rápido.</span>
                        </li>
                        <li class="flex items-start p-3 bg-gray-50 rounded-lg">
                            <svg class="w-6 h-6 text-green-600 mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                            <span>Guardar y gestionar tus archivos de Excel de forma <span class="font-semibold text-green-700">segura</span>.</span>
                        </li>
                    </ul>
                 </div>
            </div>
            
            <!-- Diapositiva 3: Qué es Excel -->
             <div id="slide-3" class="slide flex-col items-center justify-center">
                <div class="w-full">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">¿Qué es Excel?</h2>
                    <p class="text-lg text-gray-600 text-center max-w-3xl mb-8 mx-auto">Imagina un <span class="font-semibold text-green-700">cuaderno digital súper poderoso</span>. Es una hoja de cálculo que te permite organizar, calcular y analizar información de manera increíblemente rápida y visual.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 w-full mb-8">
                        <div class="bg-green-50 p-4 rounded-xl text-center shadow-sm border border-green-200"><h3 class="font-bold text-green-800 text-lg">Organizar Datos</h3><p class="text-sm text-green-700 mt-1">Listas de contactos, inventarios, horarios...</p><img src="https://placehold.co/300x150/d1fae5/065f46?text=Presupuesto" alt="Ejemplo de presupuesto" class="mt-3 rounded-lg mx-auto"></div>
                        <div class="bg-blue-50 p-4 rounded-xl text-center shadow-sm border border-blue-200"><h3 class="font-bold text-blue-800 text-lg">Realizar Cálculos</h3><p class="text-sm text-blue-700 mt-1">Sumas, promedios, porcentajes... ¡automáticamente!</p><img src="https://placehold.co/300x150/dbeafe/1e3a8a?text=Factura" alt="Ejemplo de factura" class="mt-3 rounded-lg mx-auto"></div>
                        <div class="bg-yellow-50 p-4 rounded-xl text-center shadow-sm border border-yellow-200"><h3 class="font-bold text-yellow-800 text-lg">Crear Gráficos</h3><p class="text-sm text-yellow-700 mt-1">Convertir números en impactantes visualizaciones.</p><img src="https://placehold.co/300x150/fefce8/854d0e?text=Gráfico" alt="Ejemplo de gráfico" class="mt-3 rounded-lg mx-auto"></div>
                    </div>
                    <div class="w-full text-center">
                        <button id="generate-ideas-btn" class="gemini-btn">✨ Generar más ideas de uso</button>
                        <div id="ideas-loader" class="mx-auto mt-4" style="display: none;"><div class="loader"></div></div>
                        <div id="gemini-ideas-container" class="mt-4 text-left max-w-3xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-4"></div>
                    </div>
                </div>
            </div>

            <!-- Diapositiva 4: Tour Interfaz -->
            <div id="slide-4" class="slide flex-col justify-center">
                <div class="w-full">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4 text-center">Exploración Interactiva de la Interfaz</h2>
                    <p class="text-gray-600 mb-6 text-center">¡Es hora de conocer tu nuevo espacio de trabajo! <strong class="text-green-700">Haz clic en los puntos verdes (+)</strong> para descubrir cada parte.</p>
                    <div class="relative w-full max-w-5xl mx-auto">
                        <img src="https://i.imgur.com/Pjt3ltY.png" alt="Interfaz de Excel" class="rounded-lg shadow-lg w-full">
                        <div class="hotspot" style="top: 15%; left: 40%;" onclick="showInfo('info-1')">+</div>
                        <div class="hotspot" style="top: 0%; left: 8%;" onclick="showInfo('info-2')">+</div>
                        <div class="hotspot" style="top: 25%; left: 20%;" onclick="showInfo('info-3')">+</div>
                        <div class="hotspot" style="top: 25%; left: 4%;" onclick="showInfo('info-4')">+</div>
                        <div class="hotspot" style="bottom: 5%; left: 40%;" onclick="showInfo('info-5')">+</div>
                        <div id="info-1" class="hotspot-info" style="top: 22%; left: 40%;"><h4 class="font-bold text-lg text-green-700">Cinta de Opciones</h4><p class="text-gray-600 mt-2 text-sm">Es el centro de comandos. Contiene todas las herramientas y funciones organizadas en Fichas (Inicio, Insertar, etc.).</p></div>
                        <div id="info-2" class="hotspot-info" style="top: 13%; left: 10%;"><h4 class="font-bold text-lg text-green-700">Barra de Acceso Rápido</h4><p class="text-gray-600 mt-2 text-sm">Junto al interruptor de 'Autoguardado', esta área contiene tus botones favoritos (como Guardar y Deshacer) para tenerlos siempre a mano.</p></div>
                        <div id="info-3" class="hotspot-info" style="top: 32%; left: 20%;"><h4 class="font-bold text-lg text-green-700">Barra de Fórmulas</h4><p class="text-gray-600 mt-2 text-sm">Muestra el contenido real de la celda seleccionada. ¡Aquí es donde escribes y editas tus fórmulas!</p></div>
                        <div id="info-4" class="hotspot-info" style="top: 32%; left: 4%;"><h4 class="font-bold text-lg text-green-700">Cuadro de Nombres / Nombre de Celda</h4><p class="text-gray-600 mt-2 text-sm">Muestra la referencia o "dirección" de la celda activa (ej. A1). También se le conoce como 'Nombre de Celda'.</p></div>
                        <div id="info-5" class="hotspot-info" style="bottom: 12%; left: 40%;"><h4 class="font-bold text-lg text-green-700">Barra de Estado</h4><p class="text-gray-600 mt-2 text-sm">Ofrece información útil y atajos. Aquí encuentras los 'Modos de Visualización' y el control del 'Zoom'.</p></div>
                    </div>
                </div>
            </div>
            
            <!-- Diapositiva 5: Conceptos Clave -->
            <div id="slide-5" class="slide flex-col w-full justify-center">
                <div class="w-full">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Conceptos Clave: La Estructura de Excel</h2>
                    <div class="grid md:grid-cols-3 gap-8 text-center max-w-4xl mx-auto"><div class="p-4"><h3 class="text-2xl font-semibold text-gray-700">Libro de Trabajo</h3><p class="text-gray-600 mt-2">Es el archivo completo de Excel (.xlsx). Piensa en él como un cuaderno entero.</p></div><div class="p-4"><h3 class="text-2xl font-semibold text-gray-700">Hoja de Cálculo</h3><p class="text-gray-600 mt-2">Son las "páginas" dentro del cuaderno. Puedes tener muchas hojas en un solo libro.</p></div><div class="p-4"><h3 class="text-2xl font-semibold text-gray-700">Celda</h3><p class="text-gray-600 mt-2">Es cada uno de los "cuadritos" donde introduces los datos. ¡Es la unidad básica de Excel!</p></div></div>
                    <div class="mt-8 p-6 bg-gray-50 rounded-xl border w-full max-w-2xl mx-auto"><h3 class="text-xl font-semibold text-center mb-4">¡A practicar!</h3><p class="text-center text-gray-600 mb-4">En la siguiente cuadrícula, haz clic en la celda que crees que es la <strong class="text-green-700">Celda Activa</strong>.</p><div class="excel-grid mx-auto" style="grid-template-columns: 40px repeat(3, minmax(80px, 1fr));"><div class="excel-header"></div><div class="excel-header">A</div><div class="excel-header">B</div><div class="excel-header">C</div><div class="row-header excel-header">1</div><div class="excel-cell practice-cell" data-correct="false">Texto</div><div class="excel-cell practice-cell" data-correct="false">123</div><div class="excel-cell practice-cell" data-correct="false"></div><div class="row-header excel-header">2</div><div class="excel-cell practice-cell" data-correct="false"></div><div id="target-cell" class="excel-cell practice-cell active-cell" data-correct="true">¡Aquí!</div><div class="excel-cell practice-cell" data-correct="false"></div><div class="row-header excel-header">3</div><div class="excel-cell practice-cell" data-correct="false"></div><div class="excel-cell practice-cell" data-correct="false"></div><div class="excel-cell practice-cell" data-correct="false">Final</div></div><div id="feedback-q1" class="feedback"></div></div>
                </div>
            </div>
            
            <div id="slide-6" class="slide flex-col w-full items-center justify-center"><h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Navegación Eficiente</h2><p class="text-lg text-gray-600 text-center max-w-3xl mb-8">Moverse rápido es clave. Además del ratón, ¡tus mejores amigos son las flechas del teclado!</p><div class="grid md:grid-cols-2 gap-6 w-full max-w-3xl"><div class="bg-gray-100 p-4 rounded-lg"><h3 class="font-semibold text-gray-800">Atajos Básicos</h3><ul class="list-disc list-inside mt-2 text-gray-700 space-y-1"><li><kbd class="font-mono bg-gray-200 px-2 py-1 rounded">←</kbd> <kbd>↑</kbd> <kbd>→</kbd> <kbd>↓</kbd> : Moverse una celda.</li><li><kbd class="font-mono bg-gray-200 px-2 py-1 rounded">Ctrl</kbd> + <kbd>Flechas</kbd> : Saltar al final de un bloque de datos.</li><li><kbd class="font-mono bg-gray-200 px-2 py-1 rounded">Ctrl</kbd> + <kbd>Inicio</kbd> : Volver a la celda A1.</li></ul></div><div class="bg-gray-100 p-4 rounded-lg"><h3 class="font-semibold text-gray-800">Con el Ratón</h3><ul class="list-disc list-inside mt-2 text-gray-700 space-y-1"><li><strong>Clic:</strong> Seleccionar una celda.</li><li><strong>Barras de desplazamiento:</strong> Moverse por la hoja.</li><li><strong>Pestañas de Hoja:</strong> Cambiar entre hojas.</li></ul></div></div><div class="mt-6 text-sm text-center text-gray-500 p-3 bg-green-50 rounded-md"><strong>¡Pruébalo!</strong> Intenta usar <kbd>Ctrl</kbd> + <kbd>→</kbd> en una fila con datos. Verás cómo saltas directamente al final.</div></div>
            <div id="slide-7" class="slide flex-col w-full items-center justify-center"><h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Introducir y Editar Datos</h2><p class="text-lg text-gray-600 text-center max-w-3xl mb-8">Hay 3 formas principales de corregir o cambiar el contenido de una celda.</p><div class="grid md:grid-cols-3 gap-6 w-full max-w-5xl"><div class="bg-white p-6 rounded-xl border text-center"><div class="text-3xl mb-3">1️⃣</div><h3 class="font-bold text-gray-800 text-lg">Sobrescribir</h3><p class="text-sm text-gray-600 mt-1">Simplemente haz clic en la celda y empieza a escribir. ¡Lo nuevo reemplaza lo viejo!</p></div><div class="bg-white p-6 rounded-xl border text-center"><div class="text-3xl mb-3">2️⃣</div><h3 class="font-bold text-gray-800 text-lg">Doble Clic</h3><p class="text-sm text-gray-600 mt-1">Haz doble clic dentro de la celda. El cursor aparecerá para que puedas editar el texto existente.</p></div><div class="bg-white p-6 rounded-xl border text-center"><div class="text-3xl mb-3">3️⃣</div><h3 class="font-bold text-gray-800 text-lg">Barra de Fórmulas (o F2)</h3><p class="text-sm text-gray-600 mt-1">Selecciona la celda y presiona la tecla <kbd>F2</kbd> o haz clic en la Barra de Fórmulas para editar.</p></div></div><div class="mt-8 p-6 bg-gray-50 rounded-xl border w-full max-w-lg"><h3 class="text-xl font-semibold text-center mb-4">¡A practicar la edición!</h3><p class="text-center text-gray-600 mb-4">Intenta corregir el error en la celda B1 usando <strong class="text-green-700">doble clic</strong> o la tecla <strong class="text-green-700">F2</strong>.</p><div class="excel-grid mx-auto" style="grid-template-columns: 40px repeat(2, minmax(80px, 1fr));"><div class="excel-header"></div><div class="excel-header">A</div><div class="excel-header">B</div><div class="row-header excel-header">1</div><div class="excel-cell">Producto</div><div class="excel-cell editable" id="edit-cell" contenteditable="true">Tomates</div></div><button onclick="checkEdit()" class="mt-4 w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">Verificar Corrección</button><div id="feedback-q2" class="feedback"></div></div></div>
            <div id="slide-8" class="slide flex-col w-full items-center justify-center"><h2 class="text-3xl font-bold text-gray-800 mb-2 text-center">Tu Superpoder Secreto: <span class="text-green-600">Relleno Rápido</span></h2><p class="text-lg text-gray-600 text-center max-w-3xl mb-8">Excel es inteligente. Si empiezas una tarea repetitiva, él puede terminarla por ti. ¡Esto parece magia!</p><div class="grid md:grid-cols-2 gap-8 w-full max-w-4xl items-center"><div><h3 class="font-semibold text-lg mb-2">El Problema:</h3><p class="text-gray-600 mb-4">Tienes una lista de nombres completos y quieres separar el nombre y el apellido en columnas diferentes. Hacerlo a mano es lento y aburrido.</p><img src="https://placehold.co/400x120/e5e7eb/4b5563?text=Antes:+Nombres+Juntos" alt="Antes de Relleno Rápido" class="rounded-md shadow-md"></div><div><h3 class="font-semibold text-lg mb-2">La Solución (¡Mágica!):</h3><p class="text-gray-600 mb-4">Solo tienes que escribir el primer ejemplo (ej. "Ana" en la columna Nombre). Al empezar a escribir el segundo, ¡Excel te sugerirá rellenar el resto!</p><img src="https://placehold.co/400x120/e5e7eb/4b5563?text=Después:+Relleno+Rápido+en+acción" alt="Después de Relleno Rápido" class="rounded-md shadow-md"></div></div></div>
            <div id="slide-9" class="slide flex-col w-full items-center justify-center"><h2 class="text-3xl font-bold text-gray-800 mb-4 text-center">¡Prueba el Relleno Rápido!</h2><p class="text-gray-600 mb-6 text-center max-w-3xl">Vamos a simularlo. Escribe el primer nombre y apellido en sus columnas correspondientes y luego presiona el botón.</p><div class="w-full max-w-2xl bg-gray-50 p-6 rounded-xl border"><div class="grid grid-cols-3 gap-2"><div class="font-bold text-center p-2 bg-gray-200 rounded">Nombre Completo</div><div class="font-bold text-center p-2 bg-gray-200 rounded">Nombre</div><div class="font-bold text-center p-2 bg-gray-200 rounded">Apellido</div><div class="p-2 bg-white rounded border">Ana Torres</div><input id="ff-name-1" type="text" placeholder="Escribe 'Ana'" class="p-2 border rounded"><input id="ff-lastname-1" type="text" placeholder="Escribe 'Torres'" class="p-2 border rounded"><div class="p-2 bg-white rounded border">Luis Mora</div><div id="ff-name-2" class="p-2 bg-gray-100 rounded border min-h-[42px]"></div><div id="ff-lastname-2" class="p-2 bg-gray-100 rounded border"></div><div class="p-2 bg-white rounded border">Carla Soto</div><div id="ff-name-3" class="p-2 bg-gray-100 rounded border min-h-[42px]"></div><div id="ff-lastname-3" class="p-2 bg-gray-100 rounded border"></div></div><button onclick="simulateFlashFill()" class="mt-4 w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">Activar Relleno Rápido (Simulación)</button><div id="feedback-q3" class="feedback"></div></div></div>
            <div id="slide-10" class="slide flex-col w-full items-center justify-center"><h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Guardar tu Trabajo: La Regla de Oro</h2><div class="grid md:grid-cols-2 gap-8 max-w-4xl w-full"><div class="bg-blue-50 border border-blue-200 p-6 rounded-xl"><h3 class="text-xl font-bold text-blue-800">Guardar Como...</h3><p class="mt-2 text-blue-700">Úsalo la <strong class="font-semibold">primera vez</strong> que guardas un archivo.</p><p class="mt-1 text-blue-700">Te permite elegir el <strong class="font-semibold">nombre</strong> y la <strong class="font-semibold">ubicación</strong> del archivo.</p></div><div class="bg-green-50 border border-green-200 p-6 rounded-xl"><h3 class="text-xl font-bold text-green-800">Guardar</h3><p class="mt-2 text-green-700">Úsalo para <strong class="font-semibold">actualizar los cambios</strong> en un archivo que ya existe.</p><p class="mt-1 text-green-700">¡Es mucho más rápido! Atajo: <kbd class="font-mono bg-green-200 px-2 py-1 rounded">Ctrl</kbd> + <kbd class="font-mono bg-green-200 px-2 py-1 rounded">G</kbd></p></div></div><p class="mt-8 text-lg text-gray-700 text-center max-w-2xl"><strong>Hábito Esencial:</strong> Presiona <kbd>Ctrl</kbd> + <kbd>G</kbd> cada pocos minutos. ¡Tu yo del futuro te lo agradecerá!</p></div>
            <div id="slide-11" class="slide flex-col w-full items-center justify-center"><h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Seleccionar Celdas como un Profesional</h2><div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 w-full max-w-5xl text-center"><div class="p-3 bg-gray-50 rounded-lg border"><h4 class="font-semibold">Rango</h4><p class="text-sm text-gray-600">Clic y arrastrar.</p></div><div class="p-3 bg-gray-50 rounded-lg border"><h4 class="font-semibold">Fila Entera</h4><p class="text-sm text-gray-600">Clic en el número de la fila.</p></div><div class="p-3 bg-gray-50 rounded-lg border"><h4 class="font-semibold">Columna Entera</h4><p class="text-sm text-gray-600">Clic en la letra de la columna.</p></div><div class="p-3 bg-gray-50 rounded-lg border"><h4 class="font-semibold">Celdas no contiguas</h4><p class="text-sm text-gray-600">Mantener <kbd>Ctrl</kbd> y hacer clic.</p></div></div><div class="mt-8 p-6 bg-gray-50 rounded-xl border w-full max-w-2xl"><h3 class="text-xl font-semibold text-center mb-4">¡A practicar la selección!</h3><p class="text-center text-gray-600 mb-4">Mantén presionada la tecla <strong class="text-green-700">Ctrl</strong> y haz clic únicamente en las celdas de "Frutas".</p><div class="excel-grid mx-auto text-sm" style="grid-template-columns: 40px repeat(3, minmax(80px, 1fr));"><div class="excel-header"></div><div class="excel-header">A</div><div class="excel-header">B</div><div class="excel-header">C</div><div class="row-header excel-header">1</div><div class="excel-cell select-practice" data-group="fruta">Manzana</div><div class="excel-cell select-practice" data-group="verdura">Lechuga</div><div class="excel-cell select-practice" data-group="fruta">Pera</div><div class="row-header excel-header">2</div><div class="excel-cell select-practice" data-group="verdura">Tomate</div><div class="excel-cell select-practice" data-group="fruta">Naranja</div><div class="excel-cell select-practice" data-group="verdura">Zanahoria</div></div><button onclick="checkSelection()" class="mt-4 w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">Verificar Selección</button><div id="feedback-q4" class="feedback"></div></div></div>
            <div id="slide-12" class="slide flex-col items-center justify-center text-center"><h2 class="text-3xl font-bold text-gray-800 mb-6">¡Felicidades! Resumen del Día 1</h2><p class="text-lg text-gray-600 max-w-2xl mb-8">Hoy has dado un paso gigante. Ya eres capaz de:</p><ul class="space-y-3 text-left text-gray-700 list-disc list-inside max-w-md"><li>Navegar y entender la <strong class="text-green-700">interfaz de Excel</strong>.</li><li>Introducir, editar y corregir <strong class="text-green-700">diferentes tipos de datos</strong>.</li><li>Usar el <strong class="text-green-700">Relleno Rápido</strong> para automatizar tareas.</li><li><strong class="text-green-700">Seleccionar celdas</strong> de múltiples maneras.</li><li><strong class="text-green-700">Guardar y gestionar</strong> tus archivos correctamente.</li></ul><p class="mt-8 font-semibold text-xl text-gray-800">¡Estás listo para empezar a calcular en la siguiente clase!</p></div>
        </main>

        <footer class="bg-gray-100 p-4 flex justify-between items-center border-t flex-shrink-0">
            <button id="prev-btn" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition disabled:opacity-50 disabled:cursor-not-allowed" disabled>Anterior</button>
            <div class="flex-grow mx-4">
                 <div class="w-full bg-gray-300 rounded-full h-2.5"><div id="progress-bar" class="bg-green-600 h-2.5 rounded-full" style="width: 0%"></div></div>
                <p id="slide-counter" class="text-center text-sm text-gray-600 mt-1">Diapositiva 1 / 12</p>
            </div>
            <button id="next-btn" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">Siguiente</button>
        </footer>
    </div>
    
    <button id="ai-tutor-fab" class="gemini-btn"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-5.5-2.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM10 12a5.5 5.5 0 00-5.5 5.5A.5.5 0 005 18h10a.5.5 0 00.5-.5A5.5 5.5 0 0010 12z" clip-rule="evenodd" /></svg></button>
    <div id="ai-tutor-modal"><div class="bg-gray-800 text-white p-4 rounded-t-lg flex justify-between items-center"><h3 class="font-bold text-lg">✨ Tutor IA "Chip"</h3><button id="close-ai-tutor" class="text-2xl">&times;</button></div><div id="ai-chat-box" class="flex-grow p-4 overflow-y-auto flex flex-col space-y-2"><div class="chat-message ai-message">¡Hola! Soy Chip, tu tutor de IA. Pregúntame lo que quieras sobre la lección de hoy.</div></div><div class="p-4 border-t flex"><input type="text" id="ai-tutor-input" class="flex-grow border rounded-l-lg p-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Escribe tu pregunta aquí..."><button id="ai-tutor-send" class="bg-green-600 text-white px-4 rounded-r-lg hover:bg-green-700">Enviar</button></div></div>

    <script>
        // --- Variables Globales y Selectores ---
        const slides = document.querySelectorAll('.slide');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');
        const slideCounter = document.getElementById('slide-counter');
        const generateIdeasBtn = document.getElementById('generate-ideas-btn');
        const ideasLoader = document.getElementById('ideas-loader');
        const geminiIdeasContainer = document.getElementById('gemini-ideas-container');
        const aiTutorFab = document.getElementById('ai-tutor-fab');
        const aiTutorModal = document.getElementById('ai-tutor-modal');
        const closeAiTutorBtn = document.getElementById('close-ai-tutor');
        const aiChatBox = document.getElementById('ai-chat-box');
        const aiTutorInput = document.getElementById('ai-tutor-input');
        const aiTutorSendBtn = document.getElementById('ai-tutor-send');
        
        let currentSlide = 0;
        const totalSlides = slides.length;
        const apiKey = "";

        // --- Lógica de Navegación de Diapositivas ---
        function updatePresentation() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === currentSlide) {
                    slide.classList.add('active');
                }
            });
            prevBtn.disabled = currentSlide === 0;
            nextBtn.disabled = currentSlide === totalSlides - 1;
            nextBtn.textContent = (currentSlide === totalSlides - 1) ? 'Finalizar' : 'Siguiente';
            const progressPercentage = ((currentSlide) / (totalSlides - 1)) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            slideCounter.textContent = `Diapositiva ${currentSlide + 1} / ${totalSlides}`;
            if (currentSlide !== 3) {
                document.querySelectorAll('.hotspot-info').forEach(info => info.classList.remove('show'));
            }
        }

        nextBtn.addEventListener('click', () => { if (currentSlide < totalSlides - 1) { currentSlide++; updatePresentation(); } });
        prevBtn.addEventListener('click', () => { if (currentSlide > 0) { currentSlide--; updatePresentation(); } });

        // --- Lógica de la API de Gemini ---
        async function callGemini(prompt, systemInstruction = "", retries = 3, delay = 1000) {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }] };
            if (systemInstruction) { payload.systemInstruction = { parts: [{ text: systemInstruction }] }; }
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); }
                    const result = await response.json();
                    if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts[0].text) { return result.candidates[0].content.parts[0].text; }
                    else { throw new Error("Invalid response structure from API"); }
                } catch (error) {
                    if (i === retries - 1) {
                        console.error("API call failed after multiple retries:", error);
                        return "Lo siento, no he podido procesar tu solicitud en este momento. Por favor, inténtalo de nuevo más tarde.";
                    }
                    await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                }
            }
        }

        // --- Lógica para "Generar Ideas de Uso" (Diapositiva 3) ---
        generateIdeasBtn.addEventListener('click', async () => {
            ideasLoader.style.display = 'block';
            geminiIdeasContainer.innerHTML = '';
            generateIdeasBtn.disabled = true;
            const systemPrompt = "Eres un instructor de Excel experto y creativo. Tu objetivo es inspirar a los principiantes mostrándoles aplicaciones prácticas y divertidas de Excel en la vida real.";
            const userPrompt = "Genera 3 ideas creativas y sencillas de cómo un principiante puede usar Excel. Para cada idea, proporciona un título con un emoji, y una descripción de una sola frase. Separa cada idea con un salto de línea.";
            const response = await callGemini(userPrompt, systemPrompt);
            const ideas = response.split('\n').filter(idea => idea.trim() !== '');
            ideas.forEach((idea, index) => {
                const [title, ...descriptionParts] = idea.split(':');
                const description = descriptionParts.join(':').trim();
                setTimeout(() => {
                    const ideaEl = document.createElement('div');
                    ideaEl.className = 'bg-white p-4 rounded-lg border flash-fill-item';
                    ideaEl.innerHTML = `<h4 class="font-bold text-gray-800">${title.replace(/^- /, '')}</h4><p class="text-sm text-gray-600 mt-1">${description}</p>`;
                    geminiIdeasContainer.appendChild(ideaEl);
                }, index * 200);
            });
            ideasLoader.style.display = 'none';
            generateIdeasBtn.disabled = false;
        });

        // --- Lógica para el Tutor IA ---
        aiTutorFab.addEventListener('click', () => { aiTutorModal.classList.toggle('visible'); });
        closeAiTutorBtn.addEventListener('click', () => { aiTutorModal.classList.remove('visible'); });
        async function handleTutorSend() {
            const userInput = aiTutorInput.value.trim();
            if (!userInput) return;
            const userMessageEl = document.createElement('div');
            userMessageEl.className = 'chat-message user-message';
            userMessageEl.textContent = userInput;
            aiChatBox.appendChild(userMessageEl);
            aiTutorInput.value = '';
            aiChatBox.scrollTop = aiChatBox.scrollHeight;
            const loaderEl = document.createElement('div');
            loaderEl.className = 'chat-message ai-message';
            loaderEl.innerHTML = '<div class="loader" style="width:20px; height:20px; border-top-color:#107c41;"></div>';
            aiChatBox.appendChild(loaderEl);
            aiChatBox.scrollTop = aiChatBox.scrollHeight;
            const systemPrompt = "Eres 'Chip', un tutor de IA amigable y experto en Excel para principiantes. Tu única función es responder preguntas sobre los temas del Día 1: interfaz de Excel (cinta de opciones, celdas), entrada y edición de datos, navegación, guardar/abrir archivos, selección básica y Relleno Rápido. Si te preguntan sobre temas avanzados (fórmulas, funciones, gráficos, tablas dinámicas), explica amablemente que se verá en futuras lecciones y redirige la conversación a los temas del Día 1. Mantén tus respuestas cortas, claras y motivadoras. Nunca respondas a preguntas que no estén relacionadas con Excel.";
            const aiResponse = await callGemini(userInput, systemPrompt);
            loaderEl.remove();
            const aiMessageEl = document.createElement('div');
            aiMessageEl.className = 'chat-message ai-message';
            aiMessageEl.textContent = aiResponse;
            aiChatBox.appendChild(aiMessageEl);
            aiChatBox.scrollTop = aiChatBox.scrollHeight;
        }
        aiTutorSendBtn.addEventListener('click', handleTutorSend);
        aiTutorInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') { handleTutorSend(); } });

        // --- Lógica de Interacción de Diapositivas Anteriores ---
        let activeInfo = null;
        function showInfo(infoId) {
            const infoElement = document.getElementById(infoId);
            if(activeInfo && activeInfo !== infoElement) activeInfo.classList.remove('show');
            infoElement.classList.toggle('show');
            activeInfo = infoElement.classList.contains('show') ? infoElement : null;
        }
        document.getElementById('slides-container').addEventListener('click', (e) => {
            if (!e.target.closest('.hotspot') && !e.target.closest('.hotspot-info') && activeInfo) {
                activeInfo.classList.remove('show');
                activeInfo = null;
            }
        });
        document.querySelectorAll('.practice-cell').forEach(cell => {
            cell.addEventListener('click', () => {
                const isCorrect = cell.dataset.correct === 'true';
                const feedback = document.getElementById('feedback-q1');
                feedback.textContent = isCorrect ? '¡Correcto! La celda activa es la que tiene el borde resaltado.' : 'Casi... Busca la celda con el borde verde grueso.';
                feedback.className = `feedback ${isCorrect ? 'success' : 'error'}`;
            });
        });
        function checkEdit() {
            const cell = document.getElementById('edit-cell');
            const feedback = document.getElementById('feedback-q2');
            const isCorrect = cell.textContent.trim().toLowerCase() === 'tomate';
            feedback.textContent = isCorrect ? '¡Excelente! Has corregido el texto perfectamente.' : 'Asegúrate de que la celda contenga solo la palabra "Tomate".';
            feedback.className = `feedback ${isCorrect ? 'success' : 'error'}`;
        }
        function simulateFlashFill() {
            const nameInput = document.getElementById('ff-name-1');
            const lastnameInput = document.getElementById('ff-lastname-1');
            const feedback = document.getElementById('feedback-q3');
            if (nameInput.value.trim().toLowerCase() === 'ana' && lastnameInput.value.trim().toLowerCase() === 'torres') {
                ['Luis', 'Carla'].forEach((name, i) => { setTimeout(() => { const cell = document.getElementById(`ff-name-${i+2}`); cell.textContent = name; cell.classList.add('flash-fill-item'); }, i * 200); });
                ['Mora', 'Soto'].forEach((lastname, i) => { setTimeout(() => { const cell = document.getElementById(`ff-lastname-${i+2}`); cell.textContent = lastname; cell.classList.add('flash-fill-item'); }, i * 200); });
                feedback.textContent = '¡Eso es! Excel detecta el patrón y completa el resto por ti.';
                feedback.className = 'feedback success';
            } else {
                feedback.textContent = 'Escribe "Ana" y "Torres" en sus casillas para que Excel entienda el patrón.';
                feedback.className = 'feedback error';
            }
        }
        document.querySelectorAll('.select-practice').forEach(cell => { cell.addEventListener('click', e => { if (e.ctrlKey) { cell.classList.toggle('bg-green-200'); e.preventDefault(); } }); });
        function checkSelection() {
            const feedback = document.getElementById('feedback-q4');
            let correctCount = 0, incorrectCount = 0;
            document.querySelectorAll('.select-practice').forEach(cell => {
                const isSelected = cell.classList.contains('bg-green-200');
                if (isSelected && cell.dataset.group === 'fruta') correctCount++;
                else if (isSelected && cell.dataset.group !== 'fruta') incorrectCount++;
            });
            const isCorrect = correctCount === 3 && incorrectCount === 0;
            feedback.textContent = isCorrect ? '¡Perfecto! Has seleccionado todas las frutas.' : 'No es correcto. Mantén Ctrl y selecciona solo las celdas con frutas.';
            feedback.className = `feedback ${isCorrect ? 'success' : 'error'}`;
        }
        updatePresentation();
    </script>
</body>
</html>


